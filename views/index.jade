doctype html
html(lang="en")
  head
    title DraftTracker
    link(rel="apple-touch-icon", sizes="57x57", href="/images/apple-touch-icon-57x57.png")
    link(rel="apple-touch-icon", sizes="114x114", href="/images/apple-touch-icon-114x114.png")
    link(rel="apple-touch-icon", sizes="72x72", href="/images/apple-touch-icon-72x72.png")
    link(rel="apple-touch-icon", sizes="144x144", href="/images/apple-touch-icon-144x144.png")
    link(rel="apple-touch-icon", sizes="60x60", href="/images/apple-touch-icon-60x60.png")
    link(rel="apple-touch-icon", sizes="120x120", href="/images/apple-touch-icon-120x120.png")
    link(rel="apple-touch-icon", sizes="76x76", href="/images/apple-touch-icon-76x76.png")
    link(rel="apple-touch-icon", sizes="152x152", href="/images/apple-touch-icon-152x152.png")
    link(rel="icon", type="image/png", href="/images/favicon-196x196.png", sizes="196x196")
    link(rel="icon", type="image/png", href="/images/favicon-160x160.png", sizes="160x160")
    link(rel="icon", type="image/png", href="/images/favicon-96x96.png", sizes="96x96")
    link(rel="icon", type="image/png", href="/images/favicon-16x16.png", sizes="16x16")
    link(rel="icon", type="image/png", href="/images/favicon-32x32.png", sizes="32x32")
    link(rel="stylesheet", href="/stylesheets/app.css")
    link(rel="stylesheet", href="/stylesheets/bootstrap.min.css")
    link(rel="stylesheet", href="/stylesheets/font-awesome.min.css")

  body
    .container-fluid.main-content.show-positional

      .row
        .col-md-4.col-sm-4.col-xs-12
          .page-header.pick
            h1.pick
              .span.pickCounter DraftTracker
            .btn.btn-info.instructionsButton
              | ?
        - if(user)
          .col-md-8.col-sm-8.col-xs-12.user-dropdown
            .dropdown-holder.pull-right
              .btn.btn-default.dropdown.pull-right(data-toggle="dropdown", href="#")
                | Welcome, #{user.name}
                span.caret
              ul.dropdown-menu(role="menu", aria-labelledby="dLabel")
                li
                  a(href="/logout") Logout
        - else
          .col-md-8.col-sm-8.col-xs-12.login-form
            form.form-inline.user-form.pull-right(action="/login", method="post")
              .form-group
                .error.text-danger.pull-right
                  | !{error}
              .form-group
                input.form-control(type="text", name="username", placeholder="Email")
              .form-group
                input.form-control(type="password", name="password", placeholder="Password")
              input.btn.btn-info(type="submit", value="Log In")
            .col-lg-12.col-md-12
              a.registerButton.text-muted Register

      .row
        .col-md-12.navbar-holder
          .col-md-12.navbar
            form.form-horizontal
              .col-md-3.col-sm-3.col-xs-12
                .form-group
                  .col-md-12
                    input.search.form-control(name="searchText", type="text", placeholder="Search")
              .col-md-9.col-sm-9.hidden-xs
                span.btn.btn-default.highlight
                  i.fa.fa-pencil
                span.btn.btn-default.lowlight
                  i.fa.fa-pencil
                span.checkbox.hidden-xs
                  label
                    input(name="playerToggle", type="checkbox")
                    | Hide drafted players
                span.checkbox.hidden-sm.hidden-xs
                  label
                    input(name="tooltipToggle", type="checkbox")
                    | Show projections
                //- .col-md-2.col-sm-3.hidden-xs
                //-   .checkbox
                //-     label
                //-       input(name="viewToggle", type="checkbox", checked="checked")
                //-       | Positional rankings
                span.btn.btn-primary.editRankings.hidden-xs Edit Rankings

      .row
        .col-md-12
          .positional
            - positions = _.groupBy(players, "Position")
            - orderedPositions = [{"QB": positions.QB}, {"RB": positions.RB}, {"WR": positions.WR}, {"TE": positions.TE}]
            each position, index in orderedPositions
              each positionPlayers, name in position
                .col-md-2.col-sm-6.position-column
                  table.table.table-hover.table-bordered(data-position-name=name)
                    th(colspan=2, class="breadcrumb")= name
                    each player in positionPlayers
                      - var playerName = player["Player Name"].toLowerCase()
                      - var pos = player["Position"].toLowerCase()
                      - var id = player["Id"]
                      tr.player(data-name=playerName, data-position=pos, data-id=id, class="breadcrumb")
                        td.col-md-1.rank
                          .ranking= player["Rank"]
                          input.rankingInput(value=player['Rank'])
                        td.name= player["Player Name"]

            .col-md-2.col-sm-6.position-column
              table.table.table-hover.table-bordered(data-position-name="K")
                th(colspan=2, class="breadcrumb") K
                each player in positions.K
                  - var playerName = player["Player Name"].toLowerCase()
                  - var pos = player["Position"].toLowerCase()
                  - var id = player["Id"]
                  tr.player(data-name=playerName, data-position=pos, data-id=id, class="breadcrumb")
                    td.col-md-1.rank
                      .ranking= player["Rank"]
                      input.rankingInput(value=player['Rank'])
                    td.name= player["Player Name"]

              table.table.table-hover.table-bordered(data-position-name="DEF")
                th(colspan=2, class="breadcrumb") DEF
                each player in positions.DEF
                  - var playerName = player["Player Name"].toLowerCase()
                  - var pos = player["Position"].toLowerCase()
                  - var id = player["Id"]
                  tr.player(data-name=playerName, data-position=pos, data-id=id, class="breadcrumb")
                    td.col-md-1.rank
                      .ranking= player["Rank"]
                      input.rankingInput(value=player['Rank'])
                    td.name= player["Player Name"]


          .absolute
            .col-md-3.col-sm-6.position-column
              table.table.table-hover.table-bordered
                - for (var i = 0; i < 105; ++i) {
                  - var playerName = players[i]["Player Name"].toLowerCase()
                  - var pos = players[i]["Position"]
                  - var rank = players[i]["Rank"]
                  - var id = players[i]["Id"]
                  tr.player(data-name=playerName, data-position=pos.toLowerCase(), data-id=id, class="breadcrumb")
                    td.col-md-1.rank= rank
                    td.col-md-1.pos= pos
                    td.name= players[i]["Player Name"]
                - }

            .col-md-3.col-sm-6.position-column
              table.table.table-hover.table-bordered
                - for (var i = 105; i < 210; ++i) {
                  - var playerName = players[i]["Player Name"].toLowerCase()
                  - var pos = players[i]["Position"]
                  - var rank = players[i]["Rank"]
                  - var id = players[i]["Id"]
                  tr.player(data-name=playerName, data-position=pos.toLowerCase(), data-id=id, class="breadcrumb")
                    td.col-md-1.rank= rank
                    td.col-md-1.pos= pos
                    td.name= players[i]["Player Name"]
                - }

            .col-md-3.col-sm-6.position-column
              table.table.table-hover.table-bordered
                - for (var i = 210; i < 315; ++i) {
                  - var playerName = players[i]["Player Name"].toLowerCase()
                  - var pos = players[i]["Position"]
                  - var rank = players[i]["Rank"]
                  - var id = players[i]["Id"]
                  tr.player(data-name=playerName, data-position=pos.toLowerCase(), data-id=id, class="breadcrumb")
                    td.col-md-1.rank= rank
                    td.col-md-1.pos= pos
                    td.name= players[i]["Player Name"]
                - }



          .col-md-2.col-xs-12.my-team
            table.table.table-hover.table-bordered
              th(colspan=2) Your Team
                tr
                  td.pos.col-md-2 QB
                  td.name.player(data-position="qb")
                tr
                  td.pos.col-md-2 RB
                  td.name.player(data-position="rb")
                tr
                  td.pos.col-md-2 RB
                  td.name.player(data-position="rb")
                tr
                  td.pos.col-md-2 WR
                  td.name.player(data-position="wr")
                tr
                  td.pos.col-md-2 WR
                  td.name.player(data-position="wr")
                tr
                  td.pos.col-md-2 FLX
                  td.name.player(data-position="flx")
                tr
                  td.pos.col-md-2 TE
                  td.name.player(data-position="te")
                tr
                  td.pos.col-md-2 K
                  td.name.player(data-position="k")
                tr
                  td.pos.col-md-2 DEF
                  td.name.player(data-position="def")

                tr
                  td.pos.col-md-2 BN
                  td.name.player(data-position="bn")
                tr
                  td.pos.col-md-2 BN
                  td.name.player(data-position="bn")
                tr
                  td.pos.col-md-2 BN
                  td.name.player(data-position="bn")
                tr
                  td.pos.col-md-2 BN
                  td.name.player(data-position="bn")
                tr
                  td.pos.col-md-2 BN
                  td.name.player(data-position="bn")
                tr
                  td.pos.col-md-2 BN
                  td.name.player(data-position="bn")
                tr
                  td.pos.col-md-2 BN
                  td.name.player(data-position="bn")

    #instructions.modal.fade
      .modal-dialog.modal-lg
        .modal-content
          .modal-header
            button(type="button", class="close", data-dismiss="modal")
              span(aria-hidden="true") &times;
              span.sr-only Close
            h3.modal-title Welcome to DraftTracker, a tool to use during, you know... the draft. Here are a few basics to get you started.
          .modal-body
            h4.highlighted Click on a player to mark him as taken
            p Or double-click him to say that he's on your team.  He'll then show up in your team on the right hand side.
            h4.highlighted Drag and drop the players on your team to rearrange your lineup
            p Or just leave it alone and your team will autofill based on position
            h4.highlighted The stuff in the toolbar is self-explanatory
            p Except maybe the pencil icons. You can use them to highlight players in the list, if you so choose.
            h1.highlighted Let me know if you like it!
          .modal-footer
            button.btn.btn-default(type="button", data-dismiss="modal") Close

    include ./register.jade



    script(type='text/javascript', src="javascripts/jquery-2.1.1.min.js")
    script(type='text/javascript', src="javascripts/bootstrap.min.js")
    script(type='text/javascript', src="javascripts/underscore-1.6.0.min.js")
    script(type='text/javascript', src="javascripts/analytics.js")
    script(type='text/javascript').
      allPlayers = !{JSON.stringify(players)}
      $('.navbar form').on('submit', function(){return false;});
      $('.instructionsButton').on('click', function(){ $('#instructions').modal(); })
      $('.registerButton').on('click', function(){ $('#register').modal(); })

    != js('application')

    - if(!user && !error.length)
      script(type='text/javascript').
        $('#instructions').modal();
